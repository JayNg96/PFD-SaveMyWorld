var gamestate = new Object; gamestate.init = function () { gamestate.state_types = { TITLE: 0, TUTORIAL: 1, PLAY: 2, GAME_OVER: 3 }, gamestate.current_state = gamestate.state_types.TITLE, gamestate.background = imageset.load("images/background.png"), gamestate.impact_pause = 0 }, gamestate.logic = function () { if (inputs.mouse_throttle = !1, gamestate.impact_pause > 0) gamestate.impact_pause--; else switch (gamestate.current_state) { case gamestate.state_types.TITLE: imageset.logic(), title.check_buttons(), title.start_tutorial ? (tutorial.reset(), gamestate.current_state = gamestate.state_types.TUTORIAL) : title.start_play && (conveyor.active = !0, gamestate.current_state = gamestate.state_types.PLAY); break; case gamestate.state_types.TUTORIAL: imageset.logic(), conveyor.logic(), items.logic(), scorekeeper.logic(), tutorial.logic(), particles.logic(), tutorial.finished && (gamestate.current_state = gamestate.state_types.TITLE, title.reset(), items.reset(), scorekeeper.reset()); break; case gamestate.state_types.PLAY: imageset.logic(), conveyor.logic(), items.logic(), items.item_flow(), scorekeeper.logic(), particles.logic(), scorekeeper.end_game && (gamestate.current_state = gamestate.state_types.GAME_OVER, conveyor.active = !1, title.reset()); break; case gamestate.state_types.GAME_OVER: imageset.logic(), items.logic_game_over(), scorekeeper.logic(), title.check_buttons(), particles.logic(), title.start_play && (gamestate.current_state = gamestate.state_types.PLAY, title.reset(), items.reset(), scorekeeper.reset(), conveyor.active = !0) } }, gamestate.render = function () { switch (imageset.render(gamestate.background, 0, 0, 400, 240, 0, 0), gamestate.current_state) { case gamestate.state_types.TITLE: title.render(), conveyor.render(); break; case gamestate.state_types.TUTORIAL: conveyor.render(), tutorial.render(), items.render(), scorekeeper.render(), particles.render(); break; case gamestate.state_types.PLAY: conveyor.render(), items.render(), scorekeeper.render(), scorekeeper.render_current_score(), particles.render(); break; case gamestate.state_types.GAME_OVER: conveyor.render(), items.render(), scorekeeper.render(), particles.render(), bitfont.render("Recycled " + scorekeeper.total_recycles + " items!", 200, 96, bitfont.JUSTIFY_CENTER), scorekeeper.new_high_score ? bitfont.render("NEW HIGH SCORE!", 200, 112, bitfont.JUSTIFY_CENTER) : bitfont.render("High Score: " + scorekeeper.current_high_score, 200, 112, bitfont.JUSTIFY_CENTER), 0 == items.ilist.length && title.render_button("Try Again", title.play_button_area) } };